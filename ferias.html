<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Escala de F√©rias - VISA An√°polis</title>

  <!-- Design System -->
  <link rel="stylesheet" href="./css/design-tokens.css">

  <!-- jQuery e DataTables -->
  <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
  <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>

  <style>
    body{
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      margin:0;
    }

    header{
      background:#1a3a6b;
      color:#fff;
      padding:28px 20px 26px;
      text-align:center;
      position:sticky;
      top:0;
      z-index:100;
    }

    header h1{
      margin:0;
      font-size:clamp(1.4rem,2.4vw,2.3rem);
      font-weight:900;
    }

    header h2{
      margin-top:8px;
      font-size:clamp(1rem,1.5vw,1.15rem);
      font-weight:500;
      opacity:.95;
    }

    .btn-ok-header{
      position:absolute;
      right:16px;
      top:50%;
      transform:translateY(-50%);
      background:none;
      border:none;
      color:#34C759;
      font-size:17px;
      font-weight:600;
      cursor:pointer;
      text-decoration:none;
    }

    .container{
      max-width:1400px;
      margin:22px auto 40px;
      padding:0 16px;
    }

    .card{
      background:var(--card);
      border-radius:16px;
      padding:24px;
      border:1px solid var(--line);
      box-shadow:var(--shadow2);
      margin-bottom:20px;
    }

    .card h3{
      color:var(--brand1);
      margin-bottom:16px;
      border-bottom:2px solid var(--brand1);
      padding-bottom:8px;
    }

    .filters{
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 16px;
      align-items: end; /* deixa tudo na mesma linha de base */
      width: 100%;
    }

    .filter-group{
      display:flex;
      flex-direction:column;
      min-width:0;
      justify-content:flex-end;
    }

    label{
      font-weight:600;
      margin-bottom:6px;
      display:block;
    }

    input, select{
      box-sizing: border-box;
      display:block;
      min-width:0;

      width:100%;
      padding:12px;
      border-radius:8px;
      border:1px solid var(--input-border);
      background:var(--input-bg);
      color:var(--input-text);
    }

    .btn-search{
      margin-top: 0;
      width: 100%;
      padding: 12px 24px;
      border-radius: 12px;
      border: none;
      background: linear-gradient(135deg, var(--brand1), var(--brand2));
      color: #fff;
      font-weight: 700;
      cursor: pointer;
    }

    table.dataTable thead th{
      background:var(--brand1);
      color:#fff;
      white-space:nowrap;
    }

    .small-muted{
      font-size:0.85em;
      color:var(--muted);
      text-align:center;
      margin-top:20px;
    }

    @media(max-width:768px){
      header{padding-right:70px;}
    }
  </style>
</head>
<body>

<header>
  <a href="index.html" class="btn-ok-header">OK</a>
  <h1>Vigil√¢ncia Sanit√°ria</h1>
  <h2>Escala de F√©rias</h2>
</header>

<div class="container">

  <div class="card">
    <h3>üîç Filtros</h3>
    <div class="filters">
      <div class="filter-group">
        <label for="fFiscal">Fiscal</label>
        <input type="text" id="fFiscal" placeholder="Nome do fiscal">
      </div>
      <div class="filter-group">
        <label for="fData">Data (opcional)</label>
        <input type="date" id="fData">
      </div>
      <div class="filter-group">
        <label for="fMes">M√™s</label>
        <select id="fMes"></select>
      </div>
      <div class="filter-group">
        <label for="fAno">Ano</label>
        <select id="fAno"></select>
      </div>
      <div class="filter-group">
        <label>&nbsp;</label>
        <button class="btn-search" onclick="aplicarFiltros()">Buscar</button>
      </div>
    </div>
  </div>

  <div class="card">
    <table id="tabelaFerias" class="display" style="width:100%">
      <thead>
        <tr>
          <th>Fiscal</th>
          <th>In√≠cio</th>
          <th>Fim</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div class="small-muted">Atualizado automaticamente ‚Äî (Hor√°rio de Bras√≠lia ‚Äì UTC‚àí3)</div>
</div>

<script>
  const dadosFerias = [
    {nome:"Adriana Chr(istina) de Rezende Carneiro",inicio:"2026-01-02",fim:"2026-01-13"},
    {nome:"Adriane Pereira Guimaraes",inicio:"2026-01-05",fim:"2026-01-19"},
    {nome:"Aline Castro Dam√°sio de Lima",inicio:"2026-01-05",fim:"2026-01-22"},
    {nome:"Ana Paula Rodrigues Correa Guimaraes",inicio:"2026-01-05",fim:"2026-01-19"},
    {nome:"Arianne Ferreira Vieira",inicio:"2026-01-12",fim:"2026-01-31"},
    {nome:"Cl√≥vis Rafael Borges Ferreira",inicio:"2026-01-05",fim:"2026-01-19"},
    {nome:"Daniela de Almeida Castro",inicio:"2026-01-05",fim:"2026-01-14"},
    {nome:"Edson Arantes Faria Filho",inicio:"2026-01-05",fim:"2026-01-19"},
    {nome:"Eduardo Lucas Magalh√£es Castro",inicio:"2026-02-18",fim:"2026-03-07"},
    {nome:"Fab√≠ola Pedrosa Peixoto Marques",inicio:"2026-01-07",fim:"2026-01-16"},
    {nome:"Gleiciane Maria Jos√© da Silva",inicio:"2026-02-18",fim:"2026-03-04"},
    {nome:"Geraldo Edson Rosa",inicio:"2026-01-05",fim:"2026-01-19"},
    {nome:"G√∫bio Dias Pereira",inicio:"2026-01-05",fim:"2026-01-19"},
    {nome:"Jos√© Luiz Ribeiro",inicio:"2026-01-02",fim:"2026-01-16"},
    {nome:"Juliana Ferreira Viturino",inicio:"2026-01-05",fim:"2026-01-23"},
    {nome:"Kamilla Chrystine Rolim dos Santos",inicio:"2026-01-05",fim:"2026-01-19"},
    {nome:"Lidiane Simoes Aires Campos",inicio:"2026-01-05",fim:"2026-01-19"},
    {nome:"L√≠via Brito Ribeiro",inicio:"2026-01-12",fim:"2026-01-31"},
    {nome:"Luciana Consola√ß√£o dos Santos",inicio:"2026-01-05",fim:"2026-01-19"},
    {nome:"Luciana Santana da Rocha",inicio:"2026-01-12",fim:"2026-01-26"},
    {nome:"Luciene de Souza Barbosa Gomes Silva",inicio:"2026-01-05",fim:"2026-01-24"},
    {nome:"M√°rcio Henrique Gomes Rodovalho",inicio:"2026-01-12",fim:"2026-01-31"},
    {nome:"Maria Edwiges Pinheiro de Souza Chaves",inicio:"2026-01-26",fim:"2026-02-04"},
    {nome:"Marina Perillo Navarrete Lavers",inicio:"2026-01-05",fim:"2026-01-16"},
    {nome:"Patr√≠cia Cordeiro de Morais e Souza",inicio:"2026-01-05",fim:"2026-01-24"},
    {nome:"Pedro Henrique Aires Ribeiro",inicio:"2026-01-02",fim:"2026-01-16"},
    {nome:"R√∫bia Mara de Freitas",inicio:"2026-01-20",fim:"2026-02-06"},
    {nome:"Silvia Marques Naves da Mota Souza",inicio:"2026-01-05",fim:"2026-01-24"},
    {nome:"Simone Duarte Grossi (Licen√ßa-pr√™mio)",inicio:"2025-12-18",fim:"2026-01-16"},
    {nome:"Viviane Manoel da Silva Borges",inicio:"2025-12-16",fim:"2026-01-04"},
    {nome:"Wanessa de Brito Jorge",inicio:"2025-12-29",fim:"2026-01-12"}
  ];

  let tabela;

  function initMesAno(){
    const mesSel = document.getElementById('fMes');
    const anoSel = document.getElementById('fAno');
    const hoje = new Date();

    for(let m=0;m<12;m++){
      const opt=document.createElement('option');
      opt.value=m+1;
      opt.text=new Date(2000,m,1).toLocaleString('pt-BR',{month:'long'});
      if(m===hoje.getMonth()) opt.selected=true;
      mesSel.appendChild(opt);
    }

    for(let a=2024;a<=2030;a++){
      const opt=document.createElement('option');
      opt.value=a;
      opt.text=a;
      if(a===hoje.getFullYear()) opt.selected=true;
      anoSel.appendChild(opt);
    }
  }

  function carregarTabela(){
    tabela=$('#tabelaFerias').DataTable({
      language:{url:'https://cdn.datatables.net/plug-ins/1.13.7/i18n/pt-BR.json'},
      data:[],
      columns:[
        {data:'nome'},
        {data:'inicio',render:d=>new Date(d).toLocaleDateString('pt-BR')},
        {data:'fim',render:d=>new Date(d).toLocaleDateString('pt-BR')}
      ]
    });
  }

  function aplicarFiltros(){
    const nome = document.getElementById('fFiscal').value.toUpperCase().trim();
    const dataStr = document.getElementById('fData').value; // YYYY-MM-DD
    const mes = parseInt(document.getElementById('fMes').value);
    const ano = parseInt(document.getElementById('fAno').value);

    // Intervalo do m√™s selecionado
    const inicioMes = new Date(ano, mes - 1, 1);
    const fimMes = new Date(ano, mes, 0); // √∫ltimo dia do m√™s
    fimMes.setHours(23,59,59,999);

    // Se informou uma data espec√≠fica, filtra por "quem est√° de f√©rias nessa data"
    let dataFiltro = null;
    if (dataStr) {
      dataFiltro = new Date(dataStr + 'T00:00:00');
    }

    const filtrado = dadosFerias.filter(f => {
      const dIni = new Date(f.inicio + 'T00:00:00');
      const dFim = new Date(f.fim + 'T23:59:59');

      const passaNome = (!nome || f.nome.toUpperCase().includes(nome));

      if (dataFiltro) {
        const passaData = (dataFiltro >= dIni && dataFiltro <= dFim);
        return passaNome && passaData;
      }

      // Sem data espec√≠fica: mostra registros que INTERSECTAM o m√™s selecionado
      const intersectaMes = (dIni <= fimMes && dFim >= inicioMes);
      return passaNome && intersectaMes;
    });

    tabela.clear();
    tabela.rows.add(filtrado).draw();
  }

  document.addEventListener('DOMContentLoaded',()=>{
    initMesAno();
    carregarTabela();
    aplicarFiltros();
  });
</script>

</body>
</html>
